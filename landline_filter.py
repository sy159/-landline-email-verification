import re


# 所有电话区号
area_code_list = ['0534', '0539', '0531', '0536', '0537', '0535', '0530', '0538', '0532', '0533', '0892', '0891', '0893', '0519', '0518', '0523', '025', '0517', '0511',
                  '0515', '0516', '0513', '0514', '0510', '0512', '0517', '0455', ' 0452', '0456', '0454', '0459', '0458', '0451', ' 0457', '0450', '0453', '0877', '0691',
                  '0874', '0878', '0692', '0881', '0875', '0873', '0879', '0870', '0887', '0871', '0872', '0888', '0883', '0876', '0886', '0564', '0554', '0562', '0563',
                  '0558', '0557', '0550', '0559', '0555', '0552', '0561', '0556', '0566', '0565', '0553', '0551', '021', '0813', '0837', '0827', '0811', '0834', '0810',
                  '0826', '0818', '0831', '0835', '0814', '0816', '0825', '0817', '0812', '028', '0830', '0839', '0836', '0838', '0819', '0833', '0832', '023', '0482', '0473',
                  '0474', '0475', '0476', '0483', '0471', '0477', '0472', '0479', '0478', '0470', '0354', '0356', '0357', '0353', '0359', '0358', '0350', '0351', '0355',
                  '0352', '0599', '0595', '0592', '0591', '0598', '0593', '0595', '0594', '0596', '0597', '0433', '0438', '0432', '0436', '0434', '0439', '0431', '0440',
                  '0435', '0437', '853', '0858', '0854', '0851', '0856', '0852', '0857', '0855', '0859', '0853', '0793', '0794', '0790', '0795', '0796', '0792', '0701',
                  '0798', '0791', '0797', '0799', '0713', '0728', '0724', '0710', '0719', '0722', '0716', '0715', '0717', '027', '0793', '0794', '0790', '0795', '0796',
                  '0792', '0701', '0798', '0791', '0797', '0799', '0713', '0728', '0724', '0710', '0719', '0722', '0716', '0715', '0717', '027', '0712', '0714', '0718',
                  '0711', '0663', '020', '0756', '0752', '0754', '0760', '0661', '0753', '0769', '0766', '0759', '0763', '0765', '0662', '0768', '0762', '0660', '0751',
                  '0758', '0755', '0757', '0954', '0953', '0952', '0951', '0743', '0731', '0736', '0730', '0744', '0745', '0732', '0737', '0738', '0734', '0733', '0735',
                  '0746', '0739', '0772', '0777', '0778', '0779', '0774', '0771', '0775', '0773', '0776', '0770', '0373', '0372', '0377', '0395', '0375', '0370', '0378',
                  '0371', '0393', '0398', '0394', '0391', '0376', '0374', '0392', '0379', '0396', '022', '0917', '0911', '0914', '029', '0912', '0913', '0910', '0915',
                  '0919', '0916', '0577', '0571', '0580', '0573', '0570', '0579', '0574', '0576', '0572', '0578', '0575', '0890', '0898', '0899', '0975', '0977', '0973',
                  '0974', '0976', '0971', '0972', '0417', '024', '0419', '0411', '0421', '0413', '0414', '0412', '0429', '0427', '0415', '0416', '0418', '0410', '010',
                  '0941', '0934', '0930', '0943', '0931', '0935', '0932', '0937', '0938', '0936', '0933', '852', '0316', '0318', '0319', '0311', '0317', '0312', '0310',
                  '0313', '0314', '0315', '0335']


# 清洗座机电话
def tel_filter(tel_num, area_code):
    '''
    :param tel_num: 需要清洗的座机号码
    :param area_code: 座机的区号
    :return: 清洗后的座机号码
    '''
    if not isinstance(tel_num, unicode):
        tel_num = str(tel_num)
    if not isinstance(area_code, unicode):
        area_code = str(area_code)
    tel_num = re.sub('\D', '', tel_num)  # 只保留数字
    tel_num = re.sub('\s', '', tel_num)  # 去掉空格
    tel_num = tel_num.replace('(', '')
    tel_num = tel_num.replace(')', '')
    tel_num = tel_num.replace('（', '')  # （010）84897510
    tel_num = tel_num.replace('）', '')
    if tel_num[:3] != '400':  # 全国免费电话开头都是400:
        if tel_num[0] != '0':  # 未带区号或者带区号已省去0
            if '0' + tel_num.split('-')[0] in area_code_list:  # 前面部分带上0看是否为区号
                tel_num = '0' + tel_num
            else:  # 认为没有加上区号或者没有以-分割但是带上区号的情况
                if tel_num[:2] == '86' and len(tel_num.replace('-', '')) > 11:  # 加上国际区号的情况(8605513803168)
                    tel_num = tel_num[2:]
                elif '0' + tel_num[:2] in area_code_list or '0' + tel_num[:3] in area_code_list:  # 前面区号未已-分割
                    if len(tel_num.replace('-', '')) > 10:  # 加了区号但是前面未加0
                        tel_num = '0' + tel_num
                    else:  # 可能存在电话号码刚好为区号
                        tel_num = area_code + tel_num
                elif len(tel_num) == 11 and re.match("^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$", tel_num):  # 手机号
                    pass
                else:  # 没有带上区号
                    tel_num = area_code + tel_num
        else:
            if tel_num[:3] == '086' and len(tel_num.replace('-', '')) > 11:  # 座机号前面带有国际区号
                tel_num = tel_num[3:]
            elif tel_num[:3] in area_code_list or tel_num[:4] in area_code_list:
                if len(tel_num.replace('-', '')) < 10:  # 可能存在电话号码刚好为区号
                    tel_num = area_code + tel_num
            else:
                tel_num = area_code + tel_num
    tel_num = tel_num.replace('-', '')
    return tel_num
